---
title: "工作流"
slug: workflow
---

![](https://blog.langchain.dev/content/images/2024/01/supervisor-diagram.png)

## 为什么需要工作流

随着Agent能力越来越强大，已经可以协助甚至替代人类进行思考、决策，进而逐渐[替代人类的部分工作](https://www.deeplearning.ai/the-batch/the-dawning-age-of-agents/)，

:::info 友情提示

此时掌握Agent的底层原理以及如何运用它至关重要，会成为未来有竞争力的技能之一。

:::

而当Agent深入到各行各业当中后，会发现能力远远不足以满足要求，此时就需要在当前有限的能力场景下完成复杂的功能，沿用人类的思维方式就需要：将一个复杂的问题拆分成多个简单的子问题，此时将大大提升解决问题的成功率，那这种将复杂问题根据业务逻辑拆分成多个子问题的方法论就叫做：`Agent Workflow`。

**强烈推荐大家先看吴恩达老师的这篇演讲来入门了解** Agent Workflow：

<iframe
  width="100%"
  height="515px"
  src="https://www.youtube.com/embed/sal78ACtGTc"
  frameborder="0"
  allow="autoplay; encrypted-media"
  allowfullscreen>
</iframe>

所以，当面对复杂的业务场景，`Agent Workflow Is All You Need`。

### 自动化的进化

从历史发展的角度来看，自动化能够大大提高人类的生产力，而当前绝大多数的自动化都是rule-based，通过在限定场景下编写一套规则来让机器自动运行，一旦超出预设场景时，大概率将无法正常工作，这对于企业而言是一个不可预估的潜在风险成本。

以上自动化流程毫无智能性而言，而当前是人工智能发展的元年，人工智能正在像二维码一样在中国疯狂生长，生根发芽，逐渐形成一个庞大的产业链。

### Agent 应用场景

目前 Agent 在业务场景中的主要应用场景为：

* 执行固定业务操作：例如，当用户轻声一句“我要回家了”，此时Agent便如一位贴心的管家，依据用户的偏好，悄然点亮房间的灯光，调节空调至宜人的温度，启动炊具开始煮饭，甚至播放起今日的热门歌曲，营造温馨的归家氛围。
* 做出关键决策：当用户询问关于产品的信息时，Agent则化身智者，根据用户的当前状态与需求，审慎决定是否深入探索私有产品数据库的奥秘，或直接以精准的信息回应用户。这一系列过程，皆是Decision-Making智慧的展现。
  * 知识库问答：在多数场景下，Agent需在企业或个人的知识宝库中精准挖掘，以解答用户的每一个疑问。
  * 数据驱动的新场景应对：面对错综复杂的场景，尤其是当LLM需遵循新的范式时，便需以丰富的训练数据为养分，让模型在学习的旅程中不断成长，掌握新的范式与知识，进而在业务垂类中展现出更卓越的能力。
  * 私人助手的未来愿景：未来已来，每位用户都将拥有一位专属的私人助手，如同身边的贾维斯，无论是生活的琐碎、工作的挑战还是学习的困惑，它都能一一化解。私人助手深谙每位用户的喜好、研究方向与生活习惯，以更加智能、个性化的方式助力人们的生活。
  * 自动化执行的魅力：在制造业与物流的广阔舞台上，AI助手犹如一位精明的调度师，根据物品的状态、运输的进度以及用户的需求，精心规划出一条条高效的自动化流程。在它的指挥下，货物的传输与流转变得井然有序，工作效率随之飙升。

那具体通过什么方式来集成到现有的业务系统当中去呢？

* `数据流转`：通过在关键数据处理的节点中加入 Agent 处理机制，进而提升对于对多数据源、复杂场景下的数据处理效率，从而提升数据监控和决策的过程。
* `智能决策`：Agent 非常擅长处理复杂的数据，基于不同的数据源分析并给出一个符合业务偏好的决策。
* `反馈机制`：对于安全场景或者需要人类对流程或数据进行监控的业务流程当中，可以使用Agent来对数据进行分析并报警，提取出关键信息进而让人类专家进行干预，从而不断提高系统的安全和稳定性。

### 落地场景

从理论上而言，所有涉及到决策的业务系统中，都可以使用 Agent 来重构，进而降低商业场景下的决策效率、人力成本。

* **金融**

Agent 可以应用在量化交易、风险控制以及欺诈检测等场景，在实时交易的过程中，能够根据大量的交易数据来做智能决策，甚至是识别异常情况，进而让用户规避异常风险的发生。

* **医疗健康**

Agent 能够根据患者的历史病情，当前检查报告以及症状表现给出患者的治疗方案。

这一切都可以发生在患者的家庭里面：以后每一个人都可以拥有一个AI健康医生，时刻给出健康建议。

* **制造业**

传统制造业的流水线当中都是预设好的流程，而Agent能够根据每个流程中的平均执行时间以及依赖关系来动态优化产品线，进而提升产品制造效率。

甚至能够制造各种智能机械手臂、智能塑性器等，针对于异常产品能够进行智能调整，进而提升生产线的良品率。

* **教育**

我们总是很担心AI 会替代人类，可是在教育行业，Agent 可以根据你的学习内容对你进行提问，逐步引导你掌握ground truth 的知识点。

:::info 担忧

有了Agent之后，孩子的学习方式很可能会发生变化，甚至考试内容也会加入 写Prompt 的项目。

:::

对于教育，Agent可以做的产品很多，从人类的记忆、知识点获取、知识运用以及思维锻炼等不同层面来辅助人类更好的成长。

* **创造**

AIGC 时代来临之后，人类可创造的内容就越多，人人都是内容的制造者，可以通过各种AI工具发布自己的想法，从而让世界每个人都知道自己。

## 工作流的原理

### 规划（Planning）

LLM作为Agent系统的大脑，负责规划任务执行的步骤。它可以根据输入的指令或问题，自主决定如何拆分任务为更小的子任务，并确定执行顺序。
规划过程可能涉及任务分解、自我反思、记忆（包括短期记忆和长期记忆）以及工具使用等关键功能。

### 执行（Execution）

每个Agent根据规划的结果，执行分配给自己的子任务。这些任务可能包括数据收集、处理、分析以及生成响应等。
Agent之间通过自然语言或其他通信协议进行交互，确保任务执行的协同性和一致性。

### 反馈（Feedback）

在任务执行过程中，Agent可以收集反馈信息，包括任务执行的结果、遇到的问题以及用户反馈等。
这些反馈信息被用于评估任务执行的效果，并为后续的调整和优化提供依据。

### 反思（Reflection）
根据反馈结果，LLM对规划进行调整，优化任务执行的策略和步骤。
Agent的行为和规则也可能根据性能反馈和环境变化进行调整，以确保任务的高效完成。

### 多智能体协作
在多智能体协作工作流中，每个Agent都有其专长和角色，通过协作完成整体任务。
这种协作方式不仅提高了任务执行的效率和质量，还增强了系统的鲁棒性和适应性。

## 优势和挑战

### 优势

高效性：通过任务分解和并行执行，提高了任务处理的效率。
准确性：通过引入反馈循环和迭代优化，提高了任务执行的准确性。
灵活性：Agent可定制和可扩展，能够适应不同的任务需求和环境变化。

### 挑战
复杂性：规划过程的复杂性可能导致难以预测的结果。
计算资源：训练和维护大型语言模型需要消耗大量的计算资源。
公平性与偏见：训练数据中的偏见可能反映在模型生成的内容中，需要采取措施确保生成内容的公平性和无偏见。

## 开源项目

ChatDev：一个虚拟聊天驱动的软件开发公司，利用LLMs推动软件开发过程，将开发过程细分为设计、编码、测试和文档编制四个阶段，每个阶段由不同的Agent协作完成。
MetaGPT：一个基于元编程框架的多智能体协作系统，通过引入结构化的工作流程和专门化的角色分配，提升了任务分解和执行的效率。
AutoGen：一个开源框架，旨在通过多代理对话来构建LLM应用程序，代理可基于LLM、人类输入和工具进行操作，以简化复杂任务的解决。

## Agent 和 Agent Workflow 的关系

首先LLM 是生成能力的底座能力。

其次，Agent 是基于LLM构建的具备一定原子业务功能的模块，比如说 判断当前用户意图、判断是否要调用某一个工具来完成用户意图、是否要更新当前用户状态、是否要更新记忆内容等。

最后，Agent Workflow 是一个基于Agent构建的一套业务工作流，旨在完成一个复杂的业务流程。

所以，LLM、Agent和Agent Workflow 是一个递进依赖的关系。

## Agent Workflow 的未来趋势

首先可以确定的是 Agent 未来是要赋能各行各业，所以如何将其落地在实际场景中是一个需要时代验证的问题，不过通过目前的经验来看，Workflow 是一个具备高可行性、高适配性的技术方向，通过构建有向图的方式来解决实际业务中的If-Else 逻辑（至少绝大部分的业务逻辑就是 If-Else）。

## 参考文章

* [The Integration of AI Agents in Enterprise Systems: A Guide to Agentic Workflows](https://www.quixl.ai/blog/the-integration-of-ai-agents-in-enterprise-systems-a-guide-to-agentic-workflows/)